# ================================
# Fincado â€“ SAFE & FINAL CONFIG
# ================================

RewriteEngine On

# ------------------------------------------------
# 0. ABSOLUTE INDEXNOW KEY BYPASS
# ------------------------------------------------
RewriteRule ^f79d7e3caed6497cafbcc9ee2cd99a55\.txt$ - [L]

# ------------------------------------------------
# Force NON-WWW canonical
# ------------------------------------------------
RewriteCond %{HTTP_HOST} ^www\.fincado\.com$ [NC]
RewriteRule ^(.*)$ https://fincado.com/$1 [R=301,L]

# ------------------------------------------------
# 1. SECURITY HEADERS
# ------------------------------------------------
<IfModule mod_headers.c>
  Header set Strict-Transport-Security "max-age=63072000; includeSubDomains; preload"
  Header set X-Content-Type-Options "nosniff"
  Header set X-Frame-Options "SAMEORIGIN"
  Header set Referrer-Policy "origin-when-cross-origin"
</IfModule>

# Prevent caching of IndexNow key
<Files "f79d7e3caed6497cafbcc9ee2cd99a55.txt">
  Header set Cache-Control "no-store, no-cache, must-revalidate, max-age=0"
</Files>

# ------------------------------------------------
# 2. FORCE TRAILING SLASH (SAFE)
# ------------------------------------------------
RewriteCond %{REQUEST_METHOD} !HEAD
RewriteCond %{REQUEST_URI} !^/(?:_next|api|\.well-known)/
RewriteCond %{REQUEST_FILENAME} !-f
RewriteCond %{REQUEST_FILENAME} !-d
RewriteCond %{REQUEST_URI} !\.(txt|html|css|js|json|xml|png|jpg|jpeg|webp|svg)$
RewriteCond %{REQUEST_URI} !/$
RewriteRule ^(.+)$ /$1/ [R=301,L]

# ------------------------------------------------
# 3. SEO REDIRECTS
# ------------------------------------------------
RewriteRule ^calculators/emi-calculator?$ /emi-calculator/ [R=301,L]
RewriteRule ^calculators/sip-calculator/?$ /sip-calculator/ [R=301,L]
RewriteRule ^calculators/ppf-calculator/?$ /ppf-calculator/ [R=301,L]
RewriteRule ^calculators/epf-calculator/?$ /epf-calculator/ [R=301,L]
RewriteRule ^calculators/fd-calculator/?$ /fd-calculator/ [R=301,L]
RewriteRule ^calculators/rd-calculator/?$ /rd-calculator/ [R=301,L]
RewriteRule ^calculators/gst-calculator/?$ /gst-calculator/ [R=301,L]
RewriteRule ^calculators/lumpsum-calculator/?$ /lumpsum-calculator/ [R=301,L]
RewriteRule ^calculators/simple-interest-calculator/?$ /simple-interest-calculator/ [R=301,L]
RewriteRule ^calculators/fire-calculator/?$ /fire-calculator/ [R=301,L]
RewriteRule ^calculators/swp-calculator/?$ /swp-calculator/ [R=301,L]

RewriteRule ^home-loan-calculator/?$ /loans/home-loan/ [R=301,L]
RewriteRule ^personal-loan-calculator/?$ /loans/personal-loan/ [R=301,L]
RewriteRule ^car-loan-calculator/?$ /loans/car-loan/ [R=301,L]

RewriteRule ^guides/emi-calculator-guide-2025/?$ /guides/emi-calculator-guide/ [R=301,L]
RewriteRule ^guides/sip-investment-strategies/?$ /guides/sip-investment-guide/ [R=301,L]
RewriteRule ^guides/credit-score-guide-india/?$ /guides/how-credit-score-affects-loans/ [R=301,L]

# ------------------------------------------------
# 4. NEXT.JS STATIC EXPORT
# ------------------------------------------------
RewriteCond %{REQUEST_FILENAME} -f [OR]
RewriteCond %{REQUEST_FILENAME} -d
RewriteRule ^ - [L]

RewriteCond %{REQUEST_URI} \/$
RewriteCond %{DOCUMENT_ROOT}/$1/index.html -f
RewriteRule ^(.+)/$ $1/index.html [L]

RewriteCond %{REQUEST_FILENAME}.html -f
RewriteRule ^(.+)$ $1.html [L]

# ------------------------------------------------
# 5. CUSTOM 404
# ------------------------------------------------
ErrorDocument 404 /404.html